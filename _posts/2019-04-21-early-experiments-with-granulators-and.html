---
layout: post
title: Early experiments with granulators and zero-crossing detection
date: '2019-04-21T19:04:37+02:00'
tags: []
tumblr_url: https://dariosanfilippo.tumblr.com/post/184344795151/early-experiments-with-granulators-and
---
<figure data-orig-width="2234" data-orig-height="964" class="tmblr-full"><img src="https://64.media.tumblr.com/ab68340d7edbb1946fb2799e83eb9a9f/tumblr_inline_pqbituclBP1qlphda_540.png" alt="image" data-orig-width="2234" data-orig-height="964"/></figure><p>Discontinuities in granulators are commonly handled using windowing functions, though they sometimes create a recognisable sound and I was looking for alternative techniques.</p><p>Zero-crossing (ZC) detection can be deployed to avoid discontinuities between grains.</p><p>In Pure Data, I had already done some experiments last year with this technique using audio samples and static buffers. The sounds were nice and crisp though a proper implementation wasn’t possible because of some limitations in PD.</p><p>I am now implementing my new systems in <a href="https://faust.grame.fr/" target="_blank">Faust</a> and the image shows the Faust diagram of the main unit in the granulator.</p><p>For this implementation, I’m using Faust’s read-write tables as circular buffers for the read and write indexes can be piloted through signals and there are no issues with synchronisation among several buffers.</p><p>This algorithm uses three circular buffers. One buffer is used to store the processed signal; the other two buffers are used to store the index position at which a ZC has been detected in ascending or descending signals.</p><p>“Frame“ linearly cycles through integers starting from 0 to read the samples in the buffer. At each new cycle, a new ZC position is sampled and used as a starting position for the grain. The position is then fed back into “frame“ to calculate the end position for that grain, which is the ZC position closest to the desired length of the grains. To keep consistency for ascending and descending signals, the output of the granulator is tracked down with a differentiator to calculate the slopeness that is sent back into the main module, in the “sel_zc“ object, so that the next position is sampled from the right set of ZCs.<br/></p><p>Quite happy of how it sounds and the next step might be to implement the algorithm with variable delay lines to make grain transposition possible, although synchronisation might not be as easy.</p>
